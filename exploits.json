[{
        "id": 1,
        "title": "Hikvision IP Camera Access Bypass",
        "description": "Access control bypass in Hikvision IP Cameras\n\nFull disclosure\nSep 12, 2017\n\nSynopsis:\n---------------\nMany Hikvision IP cameras contain a backdoor that allows unauthenticated impersonation of any configured user account. The vulnerability has been present in Hikvision products since at least 2014. In addition to Hikvision-branded devices, it affects many white-labeled camera products sold under a variety of brand names. Hundreds of thousands of vulnerable devices are still exposed to the Internet at the time of publishing. In addition to gaining full administrative access, the vulnerability can be used to retrieve plain-text passwords for all configured users.\n\nRisk and Mitigation:\n--------------------\nThe vulnerability poses a severe risk. Because the vulnerability is trivial to exploit, it is recommended that you immediately upgrade or disconnect all Hikvision products from the Internet or untrusted networks, or at least implement network access control rules that only allow trusted IP addresses to initiate connections to vulnerable devices. Keep in mind that many Hikvision IP cameras come with UPNP enabled by default and can expose themselves to the Internet automatically. Hikvision released firmware updates for many camera models where backdoor code is removed. If an update is available for your device, you should install it as soon as possible.\n\nBe aware that many Hikvision cameras sold online as \"Multilanguage\" or \"English, not upgradeable\" are in fact modified Chinese-language (domestic market) cameras. Attempting to upload English firmware into such cameras could result in a boot loop that can only be recovered from by flashing original Chinese-language firmware over TFTP. If you do not understand what this paragraph says or not entirely sure that your camera is an export English-language model, do not attempt to upgrade it.\n\nVulnerability details:\n----------------------\nHikvision camera API includes support for proprietary HikCGI protocol, which exposes URI endpoints through the camera's web interface. The HikCGI protocol handler checks for the presence of a parameter named \"auth\" in the query string and if that parameter contains a base64-encoded \"username:password\" string, the HikCGI API call assumes the identity of the specified user. The password is ignored.\n\nVirtually all Hikvision products come with a superuser account named \"admin\", which can be easily impersonated.  For example:\n\nRetrieve a list of all users and their roles:\n    http://camera.ip/Security/users?auth=YWRtaW46MTEK\n\nObtain a camera snapshot without authentication:\n    http://camera.ip/onvif-http/snapshot?auth=YWRtaW46MTEK\n\nAll other HikCGI calls can be impersonated in the same way, including those that add new users or flash camera firmware. Because most Hikvision devices only protect firmware images by obfuscation, one can flash arbitrary code or render hundreds of thousands of connected devices permanently unus√°veis com apenas um simples http call.\n\nAnd worst of all, one can download camera configuration:\n    http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK\n\nConfiguration backup files, unfortunately, contain usernames and plain-text passwords for all configured users. While the files are encrypted, the encryption is easily reversible, because Hikvision chose to use a static encryption key, which is derived from the password \"abcdefg\". Other Hikvision products have similarly weak encryption mechanisms.\n\nPlanted backdoor or accidental bug?\n-----------------------------------\nMake your own judgment.\n\nThere are four handlers in a typical Hikvision camera firmware that process API requests: ISAPI, PSIA, HikCGI, and Genetec. All four contain very similar authentication and authorization code. Only one of the four (HikCGI) has an additional piece of code with a very simple logic of \"if this exists, then skip all authentication\". Once you understand the code flow, the backdoor code really stands out. It is nearly impossible for a piece of code that obvious to not be noticed by development or QA teams, yet it has been present for 3+ years. The vulnerability started to quietly desaparecer from new firmware released in Jan/Feb of 2017, after Hikvision leadership made public comments that no such backdoor exists and after similar backdoors were reported in other manufacturers' products.\n\nHikvision indicated that it was a piece of debug code inadvertently left by one of developers.\n\nIt is plausible, that a developer forgot to remove a piece of test code and it went unnoticed for years. There are no attempts to hide the backdoor code which would certainly be expected in case of a deliberately planted backdoor. Chinese domestic market cameras contain the backdoor as well.\n\nTimeline:\n---------------\nMarch 5, 2017:\n    Backdoor discovered.\nMarch 6, 2017:\n    - Hikvision notified of the backdoor, technical details provided.\nMarch 7. 2017:\n    - Hikvision confirmed vulnerability and promised firmware update.\nMarch 12, 2017:\n    - Hikvision issued a memo about the vulnerability to partners.\n    - Hikvision started publishing firmware updates for affected devices.\nMay 4, 2017:\n    - ICS-Cert released advisory ICSA-17-124-01\nSep 11, 2017:\n    Vulnerability details released in the full disclosure distribution list.",
        "keywords": ["Hikvision", "camera", "webcam"],
        "date": "24-11-24",
        "severity": "null",
        "vulnerability_type": "Camera Access Bypass",
        "affected_systems": ["Hikvision IP Cameras"],
        "references": ["http://www.Hikvisioneurope.com/portal/?dir=portal/Integration%20and%20Development%20Materials/03--Protocol/01--HIKCGI%20Protocol"],
        "discovery_date": "March 5, 2017",
        "author": "null",
        "status": "null"
    },
    {
        "id": 2,
        "title": "WebcamXP and webcam 7 - Directory Traversal",
        "description": " Exploit Title: WebcamXP and Webcam7 Directory Traversal Vulnerability Google Dork: powered by webcamxp xhtml css Google Dork: powered by webcam 7 Date: 2/22/2012 Author: Silent Dream Software Link: http://dl.filekicker.com/send/file/230775-FQAC/wlite550.exe Software Link: http://dl.filekicker.com/send/file/226161-G6BD/w7inst.exe Version: WebcamXP 5.5.1.2, Webcam 7 v0.9.9.32 Tested on: Windows XP# Similar to CVE: 2008-5862 but uses backslashes instead of encoded forward slashes.http://ip:8080/..\\\\\\\\\\boot.ini",
        "keywords": ["WebcamXP", "Webcam 7", "Directory Traversal", "webcam"],
        "date": "24-11-24",
        "severity": "null",
        "vulnerability_type": "Directory Traversal",
        "affected_systems": ["Webcam"],
        "references": ["https://www.exploit-db.com/exploits/18510"],
        "discovery_date": "02-11-22",
        "author": "null",
        "status": "null"
    }
]